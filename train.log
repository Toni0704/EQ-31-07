[2024-07-11 23:29:33,715][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-11 23:29:33,720][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-11 23:29:33,720][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-11 23:29:33,772][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-11 23:31:08,929][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 55, in train
    datamodule.prepare_data()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 112, in prepare_data
    self._prepare_transform()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 273, in _prepare_transform
    self.generate_encoder()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 415, in generate_encoder
    with self.create_train_reader(schema_fields=[self.target_name]) as reader:
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 508, in create_train_reader
    return make_reader(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/reader.py", line 155, in make_reader
    dataset_metadata.get_schema_from_dataset_url(dataset_url_or_urls, hdfs_driver=hdfs_driver,
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/etl/dataset_metadata.py", line 402, in get_schema_from_dataset_url
    dataset = pq.ParquetDataset(path_or_paths, filesystem=fs, validate_schema=False, metadata_nthreads=10)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 1784, in __init__
    self._metadata_path) = _make_manifest(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 2271, in _make_manifest
    raise OSError('Passed non-file path: {}'
OSError: Passed non-file path: /Users/rishabh/TimeSeries-Interpretability-Robustness/data//syn_10percent/train
[2024-07-11 23:31:08,933][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-11_23-29-33
[2024-07-11 23:53:34,814][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-11 23:53:34,819][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-11 23:53:34,880][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-11 23:53:35,019][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 55, in train
    datamodule.prepare_data()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 112, in prepare_data
    self._prepare_transform()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 273, in _prepare_transform
    self.generate_encoder()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 415, in generate_encoder
    with self.create_train_reader(schema_fields=[self.target_name]) as reader:
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 508, in create_train_reader
    return make_reader(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/reader.py", line 155, in make_reader
    dataset_metadata.get_schema_from_dataset_url(dataset_url_or_urls, hdfs_driver=hdfs_driver,
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/etl/dataset_metadata.py", line 402, in get_schema_from_dataset_url
    dataset = pq.ParquetDataset(path_or_paths, filesystem=fs, validate_schema=False, metadata_nthreads=10)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 1784, in __init__
    self._metadata_path) = _make_manifest(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 2271, in _make_manifest
    raise OSError('Passed non-file path: {}'
OSError: Passed non-file path: /Users/rishabh/TimeSeries-Interpretability-Robustness/data//GunPointAgeSpan/train
[2024-07-11 23:53:35,022][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/multiruns/2024-07-11_23-53-01/0
[2024-07-11 23:53:35,220][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-11 23:53:35,222][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-11 23:53:35,270][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-11 23:53:35,273][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 55, in train
    datamodule.prepare_data()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 112, in prepare_data
    self._prepare_transform()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 273, in _prepare_transform
    self.generate_encoder()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 415, in generate_encoder
    with self.create_train_reader(schema_fields=[self.target_name]) as reader:
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 508, in create_train_reader
    return make_reader(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/reader.py", line 155, in make_reader
    dataset_metadata.get_schema_from_dataset_url(dataset_url_or_urls, hdfs_driver=hdfs_driver,
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/etl/dataset_metadata.py", line 402, in get_schema_from_dataset_url
    dataset = pq.ParquetDataset(path_or_paths, filesystem=fs, validate_schema=False, metadata_nthreads=10)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 1784, in __init__
    self._metadata_path) = _make_manifest(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 2271, in _make_manifest
    raise OSError('Passed non-file path: {}'
OSError: Passed non-file path: /Users/rishabh/TimeSeries-Interpretability-Robustness/data//GunPointAgeSpan/train
[2024-07-11 23:53:35,274][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/multiruns/2024-07-11_23-53-01/1
[2024-07-12 10:07:20,044][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-12 10:07:20,049][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-12 10:07:20,050][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-12 10:07:20,105][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-12 10:07:22,648][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 55, in train
    datamodule.prepare_data()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 112, in prepare_data
    self._prepare_transform()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 273, in _prepare_transform
    self.generate_encoder()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 415, in generate_encoder
    with self.create_train_reader(schema_fields=[self.target_name]) as reader:
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 508, in create_train_reader
    return make_reader(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/reader.py", line 155, in make_reader
    dataset_metadata.get_schema_from_dataset_url(dataset_url_or_urls, hdfs_driver=hdfs_driver,
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/etl/dataset_metadata.py", line 402, in get_schema_from_dataset_url
    dataset = pq.ParquetDataset(path_or_paths, filesystem=fs, validate_schema=False, metadata_nthreads=10)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 1784, in __init__
    self._metadata_path) = _make_manifest(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 2271, in _make_manifest
    raise OSError('Passed non-file path: {}'
OSError: Passed non-file path: /Users/rishabh/TimeSeries-Interpretability-Robustness/data//syn_10percent/train
[2024-07-12 10:07:22,652][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-12_10-07-19
[2024-07-12 10:08:35,275][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-12 10:08:35,281][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-12 10:08:35,281][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-12 10:08:35,335][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-12 10:08:36,667][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 55, in train
    datamodule.prepare_data()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 112, in prepare_data
    self._prepare_transform()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 273, in _prepare_transform
    self.generate_encoder()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 415, in generate_encoder
    with self.create_train_reader(schema_fields=[self.target_name]) as reader:
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 508, in create_train_reader
    return make_reader(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/reader.py", line 155, in make_reader
    dataset_metadata.get_schema_from_dataset_url(dataset_url_or_urls, hdfs_driver=hdfs_driver,
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/etl/dataset_metadata.py", line 402, in get_schema_from_dataset_url
    dataset = pq.ParquetDataset(path_or_paths, filesystem=fs, validate_schema=False, metadata_nthreads=10)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 1784, in __init__
    self._metadata_path) = _make_manifest(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 2271, in _make_manifest
    raise OSError('Passed non-file path: {}'
OSError: Passed non-file path: /Users/rishabh/TimeSeries-Interpretability-Robustness/data//syn_10percent/train
[2024-07-12 10:08:36,671][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-12_10-08-35
[2024-07-14 22:40:31,771][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-14 22:40:31,776][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-14 22:40:31,777][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-14 22:40:31,835][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-14 22:40:35,785][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 55, in train
    datamodule.prepare_data()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 112, in prepare_data
    self._prepare_transform()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 273, in _prepare_transform
    self.generate_encoder()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 415, in generate_encoder
    with self.create_train_reader(schema_fields=[self.target_name]) as reader:
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 508, in create_train_reader
    return make_reader(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/reader.py", line 155, in make_reader
    dataset_metadata.get_schema_from_dataset_url(dataset_url_or_urls, hdfs_driver=hdfs_driver,
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/etl/dataset_metadata.py", line 402, in get_schema_from_dataset_url
    dataset = pq.ParquetDataset(path_or_paths, filesystem=fs, validate_schema=False, metadata_nthreads=10)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 1784, in __init__
    self._metadata_path) = _make_manifest(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 2271, in _make_manifest
    raise OSError('Passed non-file path: {}'
OSError: Passed non-file path: /Users/rishabh/TimeSeries-Interpretability-Robustness/EQ_train_data/train
[2024-07-14 22:40:35,790][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-14_22-40-31
[2024-07-14 22:44:35,726][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-14 22:44:35,731][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-14 22:44:35,731][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-14 22:44:35,785][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-14 22:44:36,941][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 55, in train
    datamodule.prepare_data()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 112, in prepare_data
    self._prepare_transform()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 273, in _prepare_transform
    self.generate_encoder()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 415, in generate_encoder
    with self.create_train_reader(schema_fields=[self.target_name]) as reader:
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 508, in create_train_reader
    return make_reader(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/reader.py", line 155, in make_reader
    dataset_metadata.get_schema_from_dataset_url(dataset_url_or_urls, hdfs_driver=hdfs_driver,
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/etl/dataset_metadata.py", line 402, in get_schema_from_dataset_url
    dataset = pq.ParquetDataset(path_or_paths, filesystem=fs, validate_schema=False, metadata_nthreads=10)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 1784, in __init__
    self._metadata_path) = _make_manifest(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 2271, in _make_manifest
    raise OSError('Passed non-file path: {}'
OSError: Passed non-file path: /Users/rishabh/TimeSeries-Interpretability-Robustness/EQ_train_data/part-00000-173b8b4b-beab-43be-89d8-4427664f4e7d-c000 (1).parquet/train
[2024-07-14 22:44:36,945][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-14_22-44-35
[2024-07-15 20:16:11,408][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-15 20:16:11,413][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-15 20:16:11,413][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-15 20:16:11,470][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-15 20:16:12,771][petastorm.etl.dataset_metadata][INFO] - Failed loading Unischema from metadata in %s. Assuming the dataset was not created with Petastorm. Will try to construct from native Parquet schema.
[2024-07-15 20:16:12,780][petastorm.etl.dataset_metadata][INFO] - Recovering rowgroup information for the entire dataset. This can take a long time for datasets with large number of files. If this dataset was generated by Petastorm (i.e. by using "with materialize_dataset(...)") and you still see this message, this indicates that the materialization did not finish successfully.
[2024-07-15 20:16:12,839][petastorm.etl.dataset_metadata][INFO] - Failed loading Unischema from metadata in %s. Assuming the dataset was not created with Petastorm. Will try to construct from native Parquet schema.
[2024-07-15 20:16:12,840][petastorm.etl.dataset_metadata][INFO] - Recovering rowgroup information for the entire dataset. This can take a long time for datasets with large number of files. If this dataset was generated by Petastorm (i.e. by using "with materialize_dataset(...)") and you still see this message, this indicates that the materialization did not finish successfully.
[2024-07-15 20:16:12,870][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 55, in train
    datamodule.prepare_data()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 112, in prepare_data
    self._prepare_transform()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 277, in _prepare_transform
    self.generate_scaler()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 478, in generate_scaler
    feature_scaler.fit(reader, save_path_scaler)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/components/ts_scaler.py", line 68, in fit
    if x[0].shape[0] == 0:
IndexError: tuple index out of range
[2024-07-15 20:16:12,872][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-15_20-16-11
[2024-07-15 20:21:09,782][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-15 20:21:09,788][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-15 20:21:09,788][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-15 20:21:09,842][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-15 20:21:11,107][petastorm.etl.dataset_metadata][INFO] - Failed loading Unischema from metadata in %s. Assuming the dataset was not created with Petastorm. Will try to construct from native Parquet schema.
[2024-07-15 20:21:11,117][petastorm.etl.dataset_metadata][INFO] - Recovering rowgroup information for the entire dataset. This can take a long time for datasets with large number of files. If this dataset was generated by Petastorm (i.e. by using "with materialize_dataset(...)") and you still see this message, this indicates that the materialization did not finish successfully.
[2024-07-15 20:21:11,179][petastorm.etl.dataset_metadata][INFO] - Failed loading Unischema from metadata in %s. Assuming the dataset was not created with Petastorm. Will try to construct from native Parquet schema.
[2024-07-15 20:21:11,180][petastorm.etl.dataset_metadata][INFO] - Recovering rowgroup information for the entire dataset. This can take a long time for datasets with large number of files. If this dataset was generated by Petastorm (i.e. by using "with materialize_dataset(...)") and you still see this message, this indicates that the materialization did not finish successfully.
[2024-07-15 20:21:11,211][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 55, in train
    datamodule.prepare_data()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 112, in prepare_data
    self._prepare_transform()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 277, in _prepare_transform
    self.generate_scaler()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 478, in generate_scaler
    feature_scaler.fit(reader, save_path_scaler)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/components/ts_scaler.py", line 70, in fit
    if x[0].shape[0] == 0:
IndexError: tuple index out of range
[2024-07-15 20:21:11,214][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-15_20-21-09
[2024-07-15 20:30:13,533][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-15 20:30:13,538][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-15 20:30:13,539][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-15 20:30:13,593][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-15 20:30:14,823][petastorm.etl.dataset_metadata][INFO] - Failed loading Unischema from metadata in %s. Assuming the dataset was not created with Petastorm. Will try to construct from native Parquet schema.
[2024-07-15 20:30:14,833][petastorm.etl.dataset_metadata][INFO] - Recovering rowgroup information for the entire dataset. This can take a long time for datasets with large number of files. If this dataset was generated by Petastorm (i.e. by using "with materialize_dataset(...)") and you still see this message, this indicates that the materialization did not finish successfully.
[2024-07-15 20:30:14,895][petastorm.etl.dataset_metadata][INFO] - Failed loading Unischema from metadata in %s. Assuming the dataset was not created with Petastorm. Will try to construct from native Parquet schema.
[2024-07-15 20:30:14,896][petastorm.etl.dataset_metadata][INFO] - Recovering rowgroup information for the entire dataset. This can take a long time for datasets with large number of files. If this dataset was generated by Petastorm (i.e. by using "with materialize_dataset(...)") and you still see this message, this indicates that the materialization did not finish successfully.
[2024-07-15 20:30:14,928][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 55, in train
    datamodule.prepare_data()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 113, in prepare_data
    self._prepare_transform()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 278, in _prepare_transform
    self.generate_scaler()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 479, in generate_scaler
    feature_scaler.fit(reader, save_path_scaler)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/components/ts_scaler.py", line 71, in fit
    if x[0].shape[0] == 0:
IndexError: tuple index out of range
[2024-07-15 20:30:14,930][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-15_20-30-13
[2024-07-16 17:12:05,295][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-16 17:12:05,301][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-16 17:12:05,301][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-16 17:12:05,358][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-16 17:12:09,054][petastorm.etl.dataset_metadata][INFO] - Failed loading Unischema from metadata in %s. Assuming the dataset was not created with Petastorm. Will try to construct from native Parquet schema.
[2024-07-16 17:12:09,061][petastorm.etl.dataset_metadata][INFO] - Recovering rowgroup information for the entire dataset. This can take a long time for datasets with large number of files. If this dataset was generated by Petastorm (i.e. by using "with materialize_dataset(...)") and you still see this message, this indicates that the materialization did not finish successfully.
[2024-07-16 17:12:09,115][petastorm.etl.dataset_metadata][INFO] - Failed loading Unischema from metadata in %s. Assuming the dataset was not created with Petastorm. Will try to construct from native Parquet schema.
[2024-07-16 17:12:09,116][petastorm.etl.dataset_metadata][INFO] - Recovering rowgroup information for the entire dataset. This can take a long time for datasets with large number of files. If this dataset was generated by Petastorm (i.e. by using "with materialize_dataset(...)") and you still see this message, this indicates that the materialization did not finish successfully.
[2024-07-16 17:12:09,146][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 55, in train
    datamodule.prepare_data()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 113, in prepare_data
    self._prepare_transform()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 278, in _prepare_transform
    self.generate_scaler()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 479, in generate_scaler
    feature_scaler.fit(reader, save_path_scaler)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/components/ts_scaler.py", line 71, in fit
    if x[0].shape[0] == 0:
IndexError: tuple index out of range
[2024-07-16 17:12:09,149][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-16_17-12-05
[2024-07-17 15:55:21,077][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-17 15:55:21,082][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-17 15:55:21,083][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-17 15:55:21,137][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-17 15:55:23,987][petastorm.etl.dataset_metadata][INFO] - Failed loading Unischema from metadata in %s. Assuming the dataset was not created with Petastorm. Will try to construct from native Parquet schema.
[2024-07-17 15:55:23,997][petastorm.etl.dataset_metadata][INFO] - Recovering rowgroup information for the entire dataset. This can take a long time for datasets with large number of files. If this dataset was generated by Petastorm (i.e. by using "with materialize_dataset(...)") and you still see this message, this indicates that the materialization did not finish successfully.
[2024-07-17 15:55:24,058][petastorm.etl.dataset_metadata][INFO] - Failed loading Unischema from metadata in %s. Assuming the dataset was not created with Petastorm. Will try to construct from native Parquet schema.
[2024-07-17 15:55:24,059][petastorm.etl.dataset_metadata][INFO] - Recovering rowgroup information for the entire dataset. This can take a long time for datasets with large number of files. If this dataset was generated by Petastorm (i.e. by using "with materialize_dataset(...)") and you still see this message, this indicates that the materialization did not finish successfully.
[2024-07-17 15:55:24,090][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 55, in train
    datamodule.prepare_data()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 113, in prepare_data
    self._prepare_transform()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 278, in _prepare_transform
    self.generate_scaler()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 479, in generate_scaler
    feature_scaler.fit(reader, save_path_scaler)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/components/ts_scaler.py", line 71, in fit
    if x[0].shape[0] == 0:
IndexError: tuple index out of range
[2024-07-17 15:55:24,093][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-17_15-55-21
[2024-07-17 16:03:18,360][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-17 16:03:18,365][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-17 16:03:18,365][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-17 16:03:18,419][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-17 16:03:19,721][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 55, in train
    datamodule.prepare_data()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 113, in prepare_data
    self._prepare_transform()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 274, in _prepare_transform
    self.generate_encoder()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 416, in generate_encoder
    with self.create_train_reader(schema_fields=[self.target_name]) as reader:
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 509, in create_train_reader
    return make_reader(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/reader.py", line 155, in make_reader
    dataset_metadata.get_schema_from_dataset_url(dataset_url_or_urls, hdfs_driver=hdfs_driver,
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/etl/dataset_metadata.py", line 402, in get_schema_from_dataset_url
    dataset = pq.ParquetDataset(path_or_paths, filesystem=fs, validate_schema=False, metadata_nthreads=10)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 1784, in __init__
    self._metadata_path) = _make_manifest(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 2271, in _make_manifest
    raise OSError('Passed non-file path: {}'
OSError: Passed non-file path: /Users/rishabh/TimeSeries-Interpretability-Robustness/EQ_train_data/part-00000-173b8b4b-beab-43be-89d8-4427664f4e7d-c000 (1).parquet
[2024-07-17 16:03:19,725][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-17_16-03-18
[2024-07-17 17:09:21,272][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-17 17:09:21,277][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-17 17:09:21,277][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-17 17:09:21,331][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-17 17:09:24,059][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 56, in train
    cfg.model.net.input_size = datamodule.feature_shape
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 522, in feature_shape
    self.evaluate_features_shape()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 490, in evaluate_features_shape
    with self.create_train_reader(schema_fields=[self.feature_name]) as reader:
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 511, in create_train_reader
    return make_reader(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/reader.py", line 155, in make_reader
    dataset_metadata.get_schema_from_dataset_url(dataset_url_or_urls, hdfs_driver=hdfs_driver,
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/etl/dataset_metadata.py", line 402, in get_schema_from_dataset_url
    dataset = pq.ParquetDataset(path_or_paths, filesystem=fs, validate_schema=False, metadata_nthreads=10)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 1784, in __init__
    self._metadata_path) = _make_manifest(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 2271, in _make_manifest
    raise OSError('Passed non-file path: {}'
OSError: Passed non-file path: /Users/rishabh/TimeSeries-Interpretability-Robustness/EQ_train_data/part-00000-173b8b4b-beab-43be-89d8-4427664f4e7d-c000 (1).parquet
[2024-07-17 17:09:24,062][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-17_17-09-21
[2024-07-17 17:10:12,368][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-17 17:10:12,373][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-17 17:10:12,373][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-17 17:10:12,428][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-17 17:10:14,996][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 56, in train
    cfg.model.net.input_size = datamodule.feature_shape
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 522, in feature_shape
    self.evaluate_features_shape()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 490, in evaluate_features_shape
    with self.create_train_reader(schema_fields=[self.feature_name]) as reader:
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 511, in create_train_reader
    return make_reader(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/reader.py", line 155, in make_reader
    dataset_metadata.get_schema_from_dataset_url(dataset_url_or_urls, hdfs_driver=hdfs_driver,
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/etl/dataset_metadata.py", line 402, in get_schema_from_dataset_url
    dataset = pq.ParquetDataset(path_or_paths, filesystem=fs, validate_schema=False, metadata_nthreads=10)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 1784, in __init__
    self._metadata_path) = _make_manifest(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 2271, in _make_manifest
    raise OSError('Passed non-file path: {}'
OSError: Passed non-file path: /Users/rishabh/TimeSeries-Interpretability-Robustness/EQ_train_data/part-00000-173b8b4b-beab-43be-89d8-4427664f4e7d-c000 (1).parquet
[2024-07-17 17:10:15,000][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-17_17-10-12
[2024-07-17 17:25:02,868][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-17 17:25:02,873][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-17 17:25:02,873][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-17 17:25:02,930][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-17 17:25:05,510][petastorm.etl.dataset_metadata][INFO] - Failed loading Unischema from metadata in %s. Assuming the dataset was not created with Petastorm. Will try to construct from native Parquet schema.
[2024-07-17 17:25:05,517][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/etl/dataset_metadata.py", line 414, in infer_or_load_unischema
    return get_schema(dataset)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/etl/dataset_metadata.py", line 363, in get_schema
    raise PetastormMetadataError(
petastorm.etl.dataset_metadata.PetastormMetadataError: Could not find _common_metadata file. Use materialize_dataset(..) in petastorm.etl.dataset_metadata.py to generate this file in your ETL code. You can generate it on an existing dataset using petastorm-generate-metadata.py

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 56, in train
    cfg.model.net.input_size = datamodule.feature_shape
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 530, in feature_shape
    self.evaluate_features_shape()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 490, in evaluate_features_shape
    with self.create_train_reader(schema_fields=[self.feature_name]) as reader:
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 519, in create_train_reader
    return make_reader(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/reader.py", line 193, in make_reader
    return Reader(filesystem, dataset_path,
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/reader.py", line 424, in __init__
    stored_schema = infer_or_load_unischema(self.dataset)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/etl/dataset_metadata.py", line 418, in infer_or_load_unischema
    return Unischema.from_arrow_schema(dataset)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/unischema.py", line 317, in from_arrow_schema
    meta = parquet_dataset.pieces[0].get_metadata()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 1167, in get_metadata
    with self.open() as parquet:
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 1174, in open
    reader = self.open_file_func(self.path)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 1561, in _open_dataset_file
    return ParquetFile(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pyarrow/parquet/core.py", line 308, in __init__
    self.reader.open(
  File "pyarrow/_parquet.pyx", line 1227, in pyarrow._parquet.ParquetReader.open
  File "pyarrow/error.pxi", line 100, in pyarrow.lib.check_status
pyarrow.lib.ArrowInvalid: Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.
[2024-07-17 17:25:05,520][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-17_17-25-02
[2024-07-18 16:43:16,952][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-18 16:43:16,957][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-18 16:43:16,957][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-18 16:43:17,015][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-18 16:43:18,938][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 55, in train
    datamodule.prepare_data()
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 116, in prepare_data
    self.data = pd.read_csv(data_path)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 912, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 577, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 1407, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 1661, in _make_engine
    self.handles = get_handle(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/pandas/io/common.py", line 859, in get_handle
    handle = open(
FileNotFoundError: [Errno 2] No such file or directory: '/Users/rishabh/TimeSeries-Interpretability-Robustness/data//earth_500_45/comb_train.csv'
[2024-07-18 16:43:18,941][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-18_16-43-16
[2024-07-21 21:01:07,276][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-21 21:01:07,281][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-21 21:01:07,282][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-21 21:01:07,340][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-21 21:01:17,362][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-21 21:01:17,439][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() missing 1 required positional argument: 'f_sine_sum'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 60, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.time_module.TSModule':
TypeError("__init__() missing 1 required positional argument: 'f_sine_sum'")
full_key: model
[2024-07-21 21:01:17,440][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-21_21-01-07
[2024-07-21 21:02:56,343][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-21 21:02:56,348][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-21 21:02:56,348][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-21 21:02:56,407][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-21 21:03:04,930][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-21 21:03:05,010][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() missing 1 required positional argument: 'f_sine_sum'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 60, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.time_module.TSModule':
TypeError("__init__() missing 1 required positional argument: 'f_sine_sum'")
full_key: model
[2024-07-21 21:03:05,012][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-21_21-02-56
[2024-07-21 21:12:36,996][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-21 21:12:37,001][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-21 21:12:37,001][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-21 21:12:37,060][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-21 21:12:45,761][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-21 21:12:45,838][__main__][INFO] - Instantiating callbacks...
[2024-07-21 21:12:45,838][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-21 21:12:45,841][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-21 21:12:45,843][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-21 21:12:45,843][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-21 21:12:45,844][__main__][INFO] - Instantiating loggers...
[2024-07-21 21:12:45,844][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-21 21:12:45,844][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-21 21:12:45,967][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/utilities/argparse.py", line 69, in insert_env_defaults
    return fn(self, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 393, in __init__
    self._accelerator_connector = _AcceleratorConnector(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 154, in __init__
    self._accelerator_flag = self._choose_gpu_accelerator_backend()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 371, in _choose_gpu_accelerator_backend
    raise MisconfigurationException("No supported gpu backend found!")
lightning.fabric.utilities.exceptions.MisconfigurationException: No supported gpu backend found!

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 69, in train
    trainer: Trainer = hydra.utils.instantiate(cfg.trainer, callbacks=callbacks, logger=logger)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.trainer.trainer.Trainer':
MisconfigurationException('No supported gpu backend found!')
full_key: trainer
[2024-07-21 21:12:45,971][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-21_21-12-36
[2024-07-23 17:57:51,561][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-23 17:57:51,566][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-23 17:57:51,567][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-23 17:57:51,629][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-23 17:58:00,996][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-23 17:58:01,066][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() missing 1 required positional argument: 'f_sine_sum'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 60, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.time_module.TSModule':
TypeError("__init__() missing 1 required positional argument: 'f_sine_sum'")
full_key: model
[2024-07-23 17:58:01,067][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-23_17-57-51
[2024-07-23 18:16:55,550][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-23 18:16:55,555][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-23 18:16:55,555][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-23 18:16:55,626][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-23 18:17:04,379][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-23 18:17:04,460][__main__][INFO] - Instantiating callbacks...
[2024-07-23 18:17:04,460][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-23 18:17:04,463][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-23 18:17:04,465][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-23 18:17:04,466][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-23 18:17:04,466][__main__][INFO] - Instantiating loggers...
[2024-07-23 18:17:04,467][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-23 18:17:04,467][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-23 18:17:04,590][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/utilities/argparse.py", line 69, in insert_env_defaults
    return fn(self, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 393, in __init__
    self._accelerator_connector = _AcceleratorConnector(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 154, in __init__
    self._accelerator_flag = self._choose_gpu_accelerator_backend()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 371, in _choose_gpu_accelerator_backend
    raise MisconfigurationException("No supported gpu backend found!")
lightning.fabric.utilities.exceptions.MisconfigurationException: No supported gpu backend found!

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 69, in train
    trainer: Trainer = hydra.utils.instantiate(cfg.trainer, callbacks=callbacks, logger=logger)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.trainer.trainer.Trainer':
MisconfigurationException('No supported gpu backend found!')
full_key: trainer
[2024-07-23 18:17:04,594][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-23_18-16-55
[2024-07-23 18:19:28,825][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-23 18:19:28,830][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-23 18:19:28,830][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-23 18:19:28,889][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-23 18:19:37,650][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-23 18:19:37,730][__main__][INFO] - Instantiating callbacks...
[2024-07-23 18:19:37,730][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-23 18:19:37,733][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-23 18:19:37,734][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-23 18:19:37,735][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-23 18:19:37,736][__main__][INFO] - Instantiating loggers...
[2024-07-23 18:19:37,736][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-23 18:19:37,736][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-23 18:19:37,859][__main__][INFO] - Starting training!
[2024-07-23 18:19:38,762][petastorm.pytorch][ERROR] - Iteration on Petastorm DataLoader raise error: KeyError('f_sine_sum')
[2024-07-23 18:19:38,764][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 91, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 108, in run
    batch, batch_idx, dataloader_idx = next(data_fetcher)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/fetchers.py", line 136, in __next__
    self._fetch_next_batch(self.dataloader_iter)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/fetchers.py", line 150, in _fetch_next_batch
    batch = next(iterator)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/utilities/combined_loader.py", line 276, in __next__
    out = next(self._iterator)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/utilities/combined_loader.py", line 122, in __next__
    out = next(self.iterators[self._iterator_idx])
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/components/pytorch_dataloader.py", line 30, in __iter__
    for batch in self._iterate():
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/components/pytorch_dataloader.py", line 61, in _iterate
    for batch in data_loader:
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/pytorch.py", line 121, in __iter__
    for batch in self._iter_impl():
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/pytorch.py", line 193, in _iter_impl
    for row in self.reader:
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/reader.py", line 695, in __next__
    return self._results_queue_reader.read_next(self._workers_pool, self.schema, self.ngram)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/py_dict_reader_worker.py", line 81, in read_next
    list_of_rows = list(reversed(workers_pool.get_results()))
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/workers_pool/thread_pool.py", line 172, in get_results
    raise result
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/workers_pool/thread_pool.py", line 62, in run
    self._worker_impl.process(*args, **kargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/py_dict_reader_worker.py", line 168, in process
    all_cols = self._local_cache.get(cache_key,
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/cache.py", line 39, in get
    return fill_cache_func()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/py_dict_reader_worker.py", line 169, in <lambda>
    lambda: self._load_rows(parquet_file, piece, shuffle_row_drop_partition))
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/py_dict_reader_worker.py", line 193, in _load_rows
    all_rows = _apply_transform_spec(all_rows, self._transform_spec)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/py_dict_reader_worker.py", line 45, in _apply_transform_spec
    all_rows = [transform_spec.func(row) for row in all_rows]
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/py_dict_reader_worker.py", line 45, in <listcomp>
    all_rows = [transform_spec.func(row) for row in all_rows]
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/time_datamodule.py", line 409, in _transform_row
    self.f_sine_sum: data_row[self.f_sine_sum],
KeyError: 'f_sine_sum'
[2024-07-23 18:19:38,769][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-23_18-19-28
[2024-07-23 19:21:20,271][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-23 19:21:20,276][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-23 19:21:20,277][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-23 19:21:20,336][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-23 19:21:29,631][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-23 19:21:29,711][__main__][INFO] - Instantiating callbacks...
[2024-07-23 19:21:29,712][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-23 19:21:29,714][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-23 19:21:29,715][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-23 19:21:29,715][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-23 19:21:29,716][__main__][INFO] - Instantiating loggers...
[2024-07-23 19:21:29,716][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-23 19:21:29,716][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-23 19:21:29,833][__main__][INFO] - Starting training!
[2024-07-23 19:21:31,300][petastorm.pytorch][ERROR] - Iteration on Petastorm DataLoader raise error: TypeError("<lambda>() missing 1 required positional argument: 'signal_names'")
[2024-07-23 19:21:31,303][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 91, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 108, in run
    batch, batch_idx, dataloader_idx = next(data_fetcher)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/fetchers.py", line 136, in __next__
    self._fetch_next_batch(self.dataloader_iter)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/fetchers.py", line 150, in _fetch_next_batch
    batch = next(iterator)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/utilities/combined_loader.py", line 276, in __next__
    out = next(self._iterator)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/utilities/combined_loader.py", line 122, in __next__
    out = next(self.iterators[self._iterator_idx])
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/components/pytorch_dataloader.py", line 30, in __iter__
    for batch in self._iterate():
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/datamodules/components/pytorch_dataloader.py", line 61, in _iterate
    for batch in data_loader:
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/pytorch.py", line 121, in __iter__
    for batch in self._iter_impl():
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/pytorch.py", line 193, in _iter_impl
    for row in self.reader:
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/reader.py", line 695, in __next__
    return self._results_queue_reader.read_next(self._workers_pool, self.schema, self.ngram)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/py_dict_reader_worker.py", line 92, in read_next
    self._result_buffer = [schema.make_namedtuple(**row) for row in list_of_rows]
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/py_dict_reader_worker.py", line 92, in <listcomp>
    self._result_buffer = [schema.make_namedtuple(**row) for row in list_of_rows]
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/petastorm/unischema.py", line 297, in make_namedtuple
    return self._get_namedtuple()(**typed_dict)
TypeError: <lambda>() missing 1 required positional argument: 'signal_names'
[2024-07-23 19:21:32,137][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-23_19-21-20
[2024-07-23 19:26:26,474][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-23 19:26:26,479][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-23 19:26:26,479][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-23 19:26:26,537][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-23 19:26:35,082][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-23 19:26:35,165][__main__][INFO] - Instantiating callbacks...
[2024-07-23 19:26:35,166][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-23 19:26:35,169][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-23 19:26:35,170][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-23 19:26:35,170][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-23 19:26:35,171][__main__][INFO] - Instantiating loggers...
[2024-07-23 19:26:35,171][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-23 19:26:35,171][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-23 19:26:35,288][__main__][INFO] - Starting training!
[2024-07-23 19:49:51,102][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-23 19:49:51,107][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-23 19:49:51,107][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-23 19:49:51,165][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-23 19:49:59,779][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-23 19:49:59,861][__main__][INFO] - Instantiating callbacks...
[2024-07-23 19:49:59,861][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-23 19:49:59,864][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-23 19:49:59,865][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-23 19:49:59,866][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-23 19:49:59,866][__main__][INFO] - Instantiating loggers...
[2024-07-23 19:49:59,866][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-23 19:49:59,866][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-23 19:49:59,986][__main__][INFO] - Starting training!
[2024-07-23 19:52:54,649][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-23 19:52:54,654][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-23 19:52:54,654][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-23 19:52:54,713][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-23 19:53:02,947][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-23 19:53:03,004][__main__][INFO] - Instantiating callbacks...
[2024-07-23 19:53:03,005][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-23 19:53:03,007][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-23 19:53:03,009][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-23 19:53:03,009][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-23 19:53:03,010][__main__][INFO] - Instantiating loggers...
[2024-07-23 19:53:03,010][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-23 19:53:03,010][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-23 19:53:03,127][__main__][INFO] - Starting training!
[2024-07-23 20:06:34,275][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-23 20:06:34,280][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-23 20:06:34,280][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-23 20:06:34,338][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-23 20:06:42,845][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-23 20:06:42,885][__main__][INFO] - Instantiating callbacks...
[2024-07-23 20:06:42,886][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-23 20:06:42,888][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-23 20:06:42,889][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-23 20:06:42,890][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-23 20:06:42,890][__main__][INFO] - Instantiating loggers...
[2024-07-23 20:06:42,891][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-23 20:06:42,891][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-23 20:06:43,169][__main__][INFO] - Starting training!
[2024-07-23 20:14:32,464][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-23 20:14:32,468][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-23 20:14:32,469][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-23 20:14:32,514][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-23 20:14:39,204][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-23 20:14:39,252][__main__][INFO] - Instantiating callbacks...
[2024-07-23 20:14:39,253][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-23 20:14:39,255][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-23 20:14:39,256][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-23 20:14:39,256][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-23 20:14:39,257][__main__][INFO] - Instantiating loggers...
[2024-07-23 20:14:39,257][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-23 20:14:39,257][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-23 20:14:39,349][__main__][INFO] - Starting training!
[2024-07-23 21:07:29,102][__main__][INFO] - Starting testing!
[2024-07-23 21:15:24,969][__main__][INFO] - Best ckpt path: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-23_20-14-32/checkpoints/epoch_000.ckpt
[2024-07-23 21:15:24,972][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-23_20-14-32
[2024-07-23 21:15:24,973][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-07-23 23:06:58,478][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-23 23:06:58,482][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-23 23:06:58,483][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-23 23:06:58,610][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-23 23:07:07,263][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-23 23:07:07,305][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 74, in __init__
    self.train_precision_macro = torchmetrics.Precision(average='macro')
NameError: name 'torchmetrics' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 60, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.time_module.TSModule':
NameError("name 'torchmetrics' is not defined")
full_key: model
[2024-07-23 23:07:07,307][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-23_23-06-58
[2024-07-23 23:09:16,076][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-23 23:09:16,081][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-23 23:09:16,081][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-23 23:09:16,140][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-23 23:09:24,702][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-23 23:09:24,710][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.models' has no attribute 'time_module'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 6, in <module>
    from torchmetrics.classification.accuracy import Accuracy, Precision, Recall
ImportError: cannot import name 'Precision' from 'torchmetrics.classification.accuracy' (/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/classification/accuracy.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/utils.py", line 658, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.time_module.TSModule':
ImportError("cannot import name 'Precision' from 'torchmetrics.classification.accuracy' (/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/classification/accuracy.py)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 60, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.time_module.TSModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model
[2024-07-23 23:09:24,712][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-23_23-09-16
[2024-07-23 23:13:08,824][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-23 23:13:08,829][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-23 23:13:08,829][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-23 23:13:08,888][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-23 23:13:17,528][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-23 23:13:17,569][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 74, in __init__
    self.train_precision_macro = torchmetrics.Precision(average='macro')
NameError: name 'torchmetrics' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 60, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.time_module.TSModule':
NameError("name 'torchmetrics' is not defined")
full_key: model
[2024-07-23 23:13:17,571][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-23_23-13-08
[2024-07-23 23:30:57,027][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-23 23:30:57,032][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-23 23:30:57,032][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-23 23:30:57,091][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-23 23:31:05,810][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-23 23:31:05,850][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 74, in __init__
    self.train_precision_macro = torchmetrics.Precision(average='macro')
NameError: name 'torchmetrics' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 60, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.time_module.TSModule':
NameError("name 'torchmetrics' is not defined")
full_key: model
[2024-07-23 23:31:05,852][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-23_23-30-56
[2024-07-23 23:38:26,176][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-23 23:38:26,181][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-23 23:38:26,182][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-23 23:38:26,241][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-23 23:38:34,824][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-23 23:38:34,866][__main__][INFO] - Instantiating callbacks...
[2024-07-23 23:38:34,867][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-23 23:38:34,869][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-23 23:38:34,870][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-23 23:38:34,871][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-23 23:38:34,871][__main__][INFO] - Instantiating loggers...
[2024-07-23 23:38:34,871][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-23 23:38:34,871][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-23 23:38:35,023][__main__][INFO] - Starting training!
[2024-07-23 23:41:44,038][__main__][INFO] - Starting testing!
[2024-07-23 23:43:34,717][__main__][INFO] - Best ckpt path: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-23_23-38-26/checkpoints/epoch_000.ckpt
[2024-07-23 23:43:34,720][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-23_23-38-26
[2024-07-23 23:43:34,721][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-07-25 00:08:10,870][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-25 00:08:10,874][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-25 00:08:10,874][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-25 00:08:10,921][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-25 00:08:22,953][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-25 00:08:22,988][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 74, in __init__
    self.train_precision_macro = torchmetrics.Precision(average='macro')
NameError: name 'torchmetrics' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 60, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.time_module.TSModule':
NameError("name 'torchmetrics' is not defined")
full_key: model
[2024-07-25 00:08:22,990][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-25_00-08-10
[2024-07-25 00:09:49,599][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-25 00:09:49,604][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-25 00:09:49,604][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-25 00:09:49,655][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-25 00:09:56,410][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-25 00:09:56,437][__main__][INFO] - Instantiating callbacks...
[2024-07-25 00:09:56,437][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-25 00:09:56,439][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-25 00:09:56,440][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-25 00:09:56,440][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-25 00:09:56,441][__main__][INFO] - Instantiating loggers...
[2024-07-25 00:09:56,441][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-25 00:09:56,441][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-25 00:09:56,571][__main__][INFO] - Starting training!
[2024-07-25 00:12:42,902][__main__][INFO] - Starting testing!
[2024-07-25 00:14:12,160][__main__][INFO] - Best ckpt path: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-25_00-09-49/checkpoints/epoch_000.ckpt
[2024-07-25 00:14:12,162][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-25_00-09-49
[2024-07-25 00:14:12,163][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-07-28 16:41:45,087][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 16:41:45,092][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 16:41:45,093][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 16:41:45,153][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 16:41:55,613][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 16:41:55,656][__main__][INFO] - Instantiating callbacks...
[2024-07-28 16:41:55,656][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 16:41:55,658][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 16:41:55,659][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 16:41:55,660][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 16:41:55,660][__main__][INFO] - Instantiating loggers...
[2024-07-28 16:41:55,661][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 16:41:55,661][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 16:41:55,813][__main__][INFO] - Starting training!
[2024-07-28 16:45:28,542][__main__][INFO] - Starting testing!
[2024-07-28 16:47:25,931][__main__][INFO] - Best ckpt path: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_16-41-45/checkpoints/epoch_000.ckpt
[2024-07-28 16:47:25,935][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_16-41-45
[2024-07-28 16:47:25,936][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-07-28 17:00:10,514][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 17:00:10,519][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 17:00:10,519][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 17:00:10,578][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 17:00:19,163][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 17:00:19,211][__main__][INFO] - Instantiating callbacks...
[2024-07-28 17:00:19,211][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 17:00:19,214][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 17:00:19,215][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 17:00:19,215][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 17:00:19,216][__main__][INFO] - Instantiating loggers...
[2024-07-28 17:00:19,216][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 17:00:19,217][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 17:00:19,328][__main__][INFO] - Starting training!
[2024-07-28 17:04:05,494][__main__][INFO] - Starting testing!
[2024-07-28 17:06:08,853][__main__][INFO] - Best ckpt path: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_17-00-10/checkpoints/epoch_000.ckpt
[2024-07-28 17:06:08,857][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_17-00-10
[2024-07-28 17:06:08,858][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-07-28 19:00:50,730][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 19:00:50,734][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 19:00:50,734][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 19:00:50,780][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 19:00:57,521][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 19:00:57,562][__main__][INFO] - Instantiating callbacks...
[2024-07-28 19:00:57,563][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 19:00:57,567][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 19:00:57,567][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 19:00:57,568][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 19:00:57,568][__main__][INFO] - Instantiating loggers...
[2024-07-28 19:00:57,568][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 19:00:57,569][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 19:00:57,661][__main__][INFO] - Starting training!
[2024-07-28 19:04:07,919][__main__][INFO] - Starting testing!
[2024-07-28 19:05:47,100][__main__][INFO] - Best ckpt path: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_19-00-50/checkpoints/epoch_000.ckpt
[2024-07-28 19:05:47,103][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_19-00-50
[2024-07-28 19:05:47,103][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-07-28 19:11:30,694][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 19:11:30,702][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 19:11:30,703][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 19:11:30,749][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 19:11:37,381][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 19:11:37,421][__main__][INFO] - Instantiating callbacks...
[2024-07-28 19:11:37,422][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 19:11:37,424][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 19:11:37,425][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 19:11:37,425][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 19:11:37,426][__main__][INFO] - Instantiating loggers...
[2024-07-28 19:11:37,426][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 19:11:37,426][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 19:11:37,514][__main__][INFO] - Starting training!
[2024-07-28 19:14:52,396][__main__][INFO] - Starting testing!
[2024-07-28 19:16:32,267][__main__][INFO] - Best ckpt path: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_19-11-30/checkpoints/epoch_000.ckpt
[2024-07-28 19:16:32,269][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_19-11-30
[2024-07-28 19:16:32,270][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-07-28 19:22:35,783][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 19:22:35,787][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 19:22:35,787][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 19:22:35,832][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 19:22:42,482][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 19:22:42,519][__main__][INFO] - Instantiating callbacks...
[2024-07-28 19:22:42,520][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 19:22:42,522][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 19:22:42,522][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 19:22:42,523][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 19:22:42,523][__main__][INFO] - Instantiating loggers...
[2024-07-28 19:22:42,523][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 19:22:42,524][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 19:22:42,589][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/utilities/argparse.py", line 69, in insert_env_defaults
    return fn(self, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 393, in __init__
    self._accelerator_connector = _AcceleratorConnector(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 154, in __init__
    self._accelerator_flag = self._choose_gpu_accelerator_backend()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 371, in _choose_gpu_accelerator_backend
    raise MisconfigurationException("No supported gpu backend found!")
lightning.fabric.utilities.exceptions.MisconfigurationException: No supported gpu backend found!

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 75, in train
    trainer: Trainer = hydra.utils.instantiate(cfg.trainer, callbacks=callbacks, logger=logger)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.trainer.trainer.Trainer':
MisconfigurationException('No supported gpu backend found!')
full_key: trainer
[2024-07-28 19:22:42,593][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_19-22-35
[2024-07-28 19:35:24,972][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 19:35:24,976][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 19:35:24,976][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 19:35:25,024][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 19:35:31,761][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 19:35:31,781][__main__][INFO] - Instantiating callbacks...
[2024-07-28 19:35:31,781][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 19:35:31,783][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 19:35:31,784][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 19:35:31,784][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 19:35:31,785][__main__][INFO] - Instantiating loggers...
[2024-07-28 19:35:31,785][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 19:35:31,785][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 19:35:31,849][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/utilities/argparse.py", line 69, in insert_env_defaults
    return fn(self, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 393, in __init__
    self._accelerator_connector = _AcceleratorConnector(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 157, in __init__
    self._set_parallel_devices_and_init_accelerator()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 386, in _set_parallel_devices_and_init_accelerator
    raise MisconfigurationException(
lightning.fabric.utilities.exceptions.MisconfigurationException: `MPSAccelerator` can not run on your system since the accelerator is not available. The following accelerator(s) is available and can be passed into `accelerator` argument of `Trainer`: ['cpu'].

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 75, in train
    trainer: Trainer = hydra.utils.instantiate(cfg.trainer, callbacks=callbacks, logger=logger)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.trainer.trainer.Trainer':
MisconfigurationException("`MPSAccelerator` can not run on your system since the accelerator is not available. The following accelerator(s) is available and can be passed into `accelerator` argument of `Trainer`: ['cpu'].")
full_key: trainer
[2024-07-28 19:35:31,853][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_19-35-24
[2024-07-28 19:36:27,658][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 19:36:27,662][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 19:36:27,662][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 19:36:27,707][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 19:36:33,977][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 19:36:33,994][__main__][INFO] - Instantiating callbacks...
[2024-07-28 19:36:33,994][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 19:36:33,996][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 19:36:33,997][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 19:36:33,997][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 19:36:33,998][__main__][INFO] - Instantiating loggers...
[2024-07-28 19:36:33,998][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 19:36:33,998][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 19:36:34,057][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/utilities/argparse.py", line 69, in insert_env_defaults
    return fn(self, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 393, in __init__
    self._accelerator_connector = _AcceleratorConnector(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 157, in __init__
    self._set_parallel_devices_and_init_accelerator()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 386, in _set_parallel_devices_and_init_accelerator
    raise MisconfigurationException(
lightning.fabric.utilities.exceptions.MisconfigurationException: `MPSAccelerator` can not run on your system since the accelerator is not available. The following accelerator(s) is available and can be passed into `accelerator` argument of `Trainer`: ['cpu'].

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 75, in train
    trainer: Trainer = hydra.utils.instantiate(cfg.trainer, callbacks=callbacks, logger=logger)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.trainer.trainer.Trainer':
MisconfigurationException("`MPSAccelerator` can not run on your system since the accelerator is not available. The following accelerator(s) is available and can be passed into `accelerator` argument of `Trainer`: ['cpu'].")
full_key: trainer
[2024-07-28 19:36:34,061][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_19-36-27
[2024-07-28 21:25:50,762][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 21:25:50,766][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 21:25:50,767][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 21:25:50,828][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 21:25:59,348][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 21:25:59,390][__main__][INFO] - Instantiating callbacks...
[2024-07-28 21:25:59,390][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 21:25:59,393][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 21:25:59,394][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 21:25:59,394][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 21:25:59,395][__main__][INFO] - Instantiating loggers...
[2024-07-28 21:25:59,395][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 21:25:59,395][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 21:25:59,474][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/utilities/argparse.py", line 69, in insert_env_defaults
    return fn(self, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 393, in __init__
    self._accelerator_connector = _AcceleratorConnector(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 157, in __init__
    self._set_parallel_devices_and_init_accelerator()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 386, in _set_parallel_devices_and_init_accelerator
    raise MisconfigurationException(
lightning.fabric.utilities.exceptions.MisconfigurationException: `MPSAccelerator` can not run on your system since the accelerator is not available. The following accelerator(s) is available and can be passed into `accelerator` argument of `Trainer`: ['cpu'].

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 75, in train
    trainer: Trainer = hydra.utils.instantiate(cfg.trainer, callbacks=callbacks, logger=logger)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.trainer.trainer.Trainer':
MisconfigurationException("`MPSAccelerator` can not run on your system since the accelerator is not available. The following accelerator(s) is available and can be passed into `accelerator` argument of `Trainer`: ['cpu'].")
full_key: trainer
[2024-07-28 21:25:59,479][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_21-25-50
[2024-07-28 21:26:22,559][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 21:26:22,563][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 21:26:22,564][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 21:26:22,623][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 21:26:30,865][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 21:26:30,890][__main__][INFO] - Instantiating callbacks...
[2024-07-28 21:26:30,890][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 21:26:30,893][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 21:26:30,894][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 21:26:30,895][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 21:26:30,896][__main__][INFO] - Instantiating loggers...
[2024-07-28 21:26:30,896][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 21:26:30,896][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 21:26:31,013][__main__][INFO] - Starting training!
[2024-07-28 21:30:19,247][__main__][INFO] - Starting testing!
[2024-07-28 21:32:16,356][__main__][INFO] - Best ckpt path: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_21-26-22/checkpoints/epoch_000.ckpt
[2024-07-28 21:32:16,358][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_21-26-22
[2024-07-28 21:32:16,359][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-07-28 21:42:33,023][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 21:42:33,029][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 21:42:33,029][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 21:42:33,090][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 21:42:41,965][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 21:42:42,010][__main__][INFO] - Instantiating callbacks...
[2024-07-28 21:42:42,010][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 21:42:42,012][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 21:42:42,014][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 21:42:42,014][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 21:42:42,015][__main__][INFO] - Instantiating loggers...
[2024-07-28 21:42:42,015][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 21:42:42,015][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 21:42:42,137][__main__][INFO] - Starting training!
[2024-07-28 21:46:23,448][__main__][INFO] - Starting testing!
[2024-07-28 21:48:14,739][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 21:48:14,744][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 21:48:14,745][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 21:48:14,807][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 21:48:21,366][__main__][INFO] - Best ckpt path: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_21-42-32/checkpoints/epoch_000.ckpt
[2024-07-28 21:48:21,369][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_21-42-32
[2024-07-28 21:48:21,370][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-07-28 21:48:23,827][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 21:48:23,851][__main__][INFO] - Instantiating callbacks...
[2024-07-28 21:48:23,852][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 21:48:23,854][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 21:48:23,855][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 21:48:23,856][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 21:48:23,856][__main__][INFO] - Instantiating loggers...
[2024-07-28 21:48:23,857][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 21:48:23,857][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 21:48:23,965][__main__][INFO] - Starting training!
[2024-07-28 21:49:49,390][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 21:49:49,394][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 21:49:49,395][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 21:49:49,455][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 21:49:57,697][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 21:49:57,722][__main__][INFO] - Instantiating callbacks...
[2024-07-28 21:49:57,722][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 21:49:57,725][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 21:49:57,726][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 21:49:57,727][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 21:49:57,727][__main__][INFO] - Instantiating loggers...
[2024-07-28 21:49:57,728][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 21:49:57,728][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 21:49:57,805][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/utilities/argparse.py", line 69, in insert_env_defaults
    return fn(self, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 393, in __init__
    self._accelerator_connector = _AcceleratorConnector(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 157, in __init__
    self._set_parallel_devices_and_init_accelerator()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 386, in _set_parallel_devices_and_init_accelerator
    raise MisconfigurationException(
lightning.fabric.utilities.exceptions.MisconfigurationException: `MPSAccelerator` can not run on your system since the accelerator is not available. The following accelerator(s) is available and can be passed into `accelerator` argument of `Trainer`: ['cpu'].

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 75, in train
    trainer: Trainer = hydra.utils.instantiate(cfg.trainer, callbacks=callbacks, logger=logger)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.trainer.trainer.Trainer':
MisconfigurationException("`MPSAccelerator` can not run on your system since the accelerator is not available. The following accelerator(s) is available and can be passed into `accelerator` argument of `Trainer`: ['cpu'].")
full_key: trainer
[2024-07-28 21:49:57,810][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_21-49-49
[2024-07-28 22:05:16,257][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 22:05:16,262][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 22:05:16,263][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 22:05:16,337][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 22:05:25,032][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 22:05:25,076][__main__][INFO] - Instantiating callbacks...
[2024-07-28 22:05:25,076][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 22:05:25,079][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 22:05:25,080][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 22:05:25,080][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 22:05:25,081][__main__][INFO] - Instantiating loggers...
[2024-07-28 22:05:25,081][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 22:05:25,081][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 22:05:25,164][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/utilities/argparse.py", line 69, in insert_env_defaults
    return fn(self, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 393, in __init__
    self._accelerator_connector = _AcceleratorConnector(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 157, in __init__
    self._set_parallel_devices_and_init_accelerator()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 386, in _set_parallel_devices_and_init_accelerator
    raise MisconfigurationException(
lightning.fabric.utilities.exceptions.MisconfigurationException: `MPSAccelerator` can not run on your system since the accelerator is not available. The following accelerator(s) is available and can be passed into `accelerator` argument of `Trainer`: ['cpu'].

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 75, in train
    trainer: Trainer = hydra.utils.instantiate(cfg.trainer, callbacks=callbacks, logger=logger)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.trainer.trainer.Trainer':
MisconfigurationException("`MPSAccelerator` can not run on your system since the accelerator is not available. The following accelerator(s) is available and can be passed into `accelerator` argument of `Trainer`: ['cpu'].")
full_key: trainer
[2024-07-28 22:05:25,168][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_22-05-16
[2024-07-28 22:29:05,889][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 22:29:05,894][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 22:29:05,894][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 22:29:05,957][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 22:29:14,691][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 22:29:14,734][__main__][INFO] - Instantiating callbacks...
[2024-07-28 22:29:14,735][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 22:29:14,737][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 22:29:14,738][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 22:29:14,739][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 22:29:14,739][__main__][INFO] - Instantiating loggers...
[2024-07-28 22:29:14,740][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 22:29:14,740][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 22:29:14,818][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/utilities/argparse.py", line 69, in insert_env_defaults
    return fn(self, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 393, in __init__
    self._accelerator_connector = _AcceleratorConnector(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 157, in __init__
    self._set_parallel_devices_and_init_accelerator()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/accelerator_connector.py", line 386, in _set_parallel_devices_and_init_accelerator
    raise MisconfigurationException(
lightning.fabric.utilities.exceptions.MisconfigurationException: `MPSAccelerator` can not run on your system since the accelerator is not available. The following accelerator(s) is available and can be passed into `accelerator` argument of `Trainer`: ['cpu'].

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 75, in train
    trainer: Trainer = hydra.utils.instantiate(cfg.trainer, callbacks=callbacks, logger=logger)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'lightning.pytorch.trainer.trainer.Trainer':
MisconfigurationException("`MPSAccelerator` can not run on your system since the accelerator is not available. The following accelerator(s) is available and can be passed into `accelerator` argument of `Trainer`: ['cpu'].")
full_key: trainer
[2024-07-28 22:29:14,823][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_22-29-05
[2024-07-28 22:46:46,430][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 22:46:46,435][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 22:46:46,435][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 22:46:46,496][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 22:46:54,971][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 22:46:54,995][__main__][INFO] - Instantiating callbacks...
[2024-07-28 22:46:54,995][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 22:46:54,998][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 22:46:54,999][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 22:46:54,999][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 22:46:55,001][__main__][INFO] - Instantiating loggers...
[2024-07-28 22:46:55,001][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 22:46:55,001][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 22:46:55,112][__main__][INFO] - Starting training!
[2024-07-28 22:46:56,679][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 97, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 911, in _run
    self.strategy.setup(self)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/strategies/single_device.py", line 74, in setup
    super().setup(trainer)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/strategies/strategy.py", line 148, in setup
    self.setup_optimizers(trainer)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/strategies/strategy.py", line 138, in setup_optimizers
    self.optimizers, self.lr_scheduler_configs = _init_optimizers_and_lr_schedulers(self.lightning_module)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/core/optimizer.py", line 171, in _init_optimizers_and_lr_schedulers
    optim_conf = call._call_lightning_module_hook(model.trainer, "configure_optimizers", pl_module=model)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 142, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 180, in configure_optimizers
    optimizer = self.hparams.optimizer(params=self.parameters())
TypeError: __init__() got an unexpected keyword argument 'lr'
[2024-07-28 22:46:56,686][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_22-46-46
[2024-07-28 22:51:54,965][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 22:51:54,970][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 22:51:54,970][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 22:51:55,032][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 22:52:03,783][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 22:52:03,807][__main__][INFO] - Instantiating callbacks...
[2024-07-28 22:52:03,807][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 22:52:03,810][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 22:52:03,811][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 22:52:03,812][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 22:52:03,812][__main__][INFO] - Instantiating loggers...
[2024-07-28 22:52:03,813][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 22:52:03,813][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 22:52:03,923][__main__][INFO] - Starting training!
[2024-07-28 23:12:26,007][__main__][INFO] - Starting testing!
[2024-07-28 23:12:34,896][__main__][INFO] - Best ckpt path: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_22-51-54/checkpoints/epoch_000.ckpt
[2024-07-28 23:12:34,898][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_22-51-54
[2024-07-28 23:12:34,898][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-07-28 23:24:26,992][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 23:24:26,996][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 23:24:26,997][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 23:24:27,061][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 23:24:35,582][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 23:24:35,609][__main__][INFO] - Instantiating callbacks...
[2024-07-28 23:24:35,610][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 23:24:35,612][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 23:24:35,613][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 23:24:35,614][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 23:24:35,614][__main__][INFO] - Instantiating loggers...
[2024-07-28 23:24:35,615][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 23:24:35,615][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 23:24:35,727][__main__][INFO] - Starting training!
[2024-07-28 23:24:38,881][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 97, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 113, in validation_step
    self.val_acc(preds, targets)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 236, in forward
    self._forward_cache = self._forward_reduce_state_update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 302, in _forward_reduce_state_update
    self.update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 400, in wrapped_func
    raise err
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 390, in wrapped_func
    update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/classification/stat_scores.py", line 175, in update
    _binary_stat_scores_tensor_validation(preds, target, self.multidim_average, self.ignore_index)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/functional/classification/stat_scores.py", line 61, in _binary_stat_scores_tensor_validation
    _check_same_shape(preds, target)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/utilities/checks.py", line 41, in _check_same_shape
    raise RuntimeError(
RuntimeError: Predictions and targets are expected to have the same shape, but got torch.Size([32]) and torch.Size([32, 2]).
[2024-07-28 23:24:38,965][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_23-24-26
[2024-07-28 23:32:11,186][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 23:32:11,191][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 23:32:11,191][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 23:32:11,250][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 23:32:19,974][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 23:32:20,003][__main__][INFO] - Instantiating callbacks...
[2024-07-28 23:32:20,003][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 23:32:20,006][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 23:32:20,007][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 23:32:20,007][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 23:32:20,008][__main__][INFO] - Instantiating loggers...
[2024-07-28 23:32:20,008][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 23:32:20,008][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 23:32:20,118][__main__][INFO] - Starting training!
[2024-07-28 23:32:22,780][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 97, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 113, in validation_step
    self.val_acc(preds, targets)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 236, in forward
    self._forward_cache = self._forward_reduce_state_update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 302, in _forward_reduce_state_update
    self.update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 400, in wrapped_func
    raise err
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 390, in wrapped_func
    update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/classification/stat_scores.py", line 175, in update
    _binary_stat_scores_tensor_validation(preds, target, self.multidim_average, self.ignore_index)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/functional/classification/stat_scores.py", line 61, in _binary_stat_scores_tensor_validation
    _check_same_shape(preds, target)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/utilities/checks.py", line 41, in _check_same_shape
    raise RuntimeError(
RuntimeError: Predictions and targets are expected to have the same shape, but got torch.Size([32]) and torch.Size([32, 2]).
[2024-07-28 23:32:22,858][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_23-32-11
[2024-07-28 23:34:28,661][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-28 23:34:28,666][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-28 23:34:28,666][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-28 23:34:28,726][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-28 23:34:37,418][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-28 23:34:37,443][__main__][INFO] - Instantiating callbacks...
[2024-07-28 23:34:37,443][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-28 23:34:37,446][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-28 23:34:37,447][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-28 23:34:37,447][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-28 23:34:37,448][__main__][INFO] - Instantiating loggers...
[2024-07-28 23:34:37,448][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-28 23:34:37,448][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-28 23:34:37,558][__main__][INFO] - Starting training!
[2024-07-28 23:34:40,520][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 97, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 113, in validation_step
    self.val_acc(preds, targets)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 236, in forward
    self._forward_cache = self._forward_reduce_state_update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 302, in _forward_reduce_state_update
    self.update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 400, in wrapped_func
    raise err
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 390, in wrapped_func
    update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/classification/stat_scores.py", line 175, in update
    _binary_stat_scores_tensor_validation(preds, target, self.multidim_average, self.ignore_index)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/functional/classification/stat_scores.py", line 61, in _binary_stat_scores_tensor_validation
    _check_same_shape(preds, target)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/utilities/checks.py", line 41, in _check_same_shape
    raise RuntimeError(
RuntimeError: Predictions and targets are expected to have the same shape, but got torch.Size([32]) and torch.Size([32, 2]).
[2024-07-28 23:34:40,791][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-28_23-34-28
[2024-07-29 22:08:44,851][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-29 22:08:44,856][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-29 22:08:44,857][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-29 22:08:44,917][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-29 22:08:45,570][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 981, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.datamodules.time_datamodule.TimeDataModule'; 'src.datamodules.time_datamodule' is not a package

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.datamodules.time_datamodule.TimeDataModule':
ModuleNotFoundError("No module named 'src.datamodules.time_datamodule.TimeDataModule'; 'src.datamodules.time_datamodule' is not a package")
Are you sure that 'TimeDataModule' is importable from module 'src.datamodules.time_datamodule'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 56, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.datamodule)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.datamodules.time_datamodule.TimeDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: datamodule
[2024-07-29 22:08:45,572][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-29_22-08-44
[2024-07-29 22:10:16,504][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-29 22:10:16,509][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-29 22:10:16,509][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-29 22:10:16,570][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-29 22:10:16,947][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 981, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.datamodules.time_datamodule.TimeDataModule'; 'src.datamodules.time_datamodule' is not a package

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.datamodules.time_datamodule.TimeDataModule':
ModuleNotFoundError("No module named 'src.datamodules.time_datamodule.TimeDataModule'; 'src.datamodules.time_datamodule' is not a package")
Are you sure that 'TimeDataModule' is importable from module 'src.datamodules.time_datamodule'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 56, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.datamodule)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.datamodules.time_datamodule.TimeDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: datamodule
[2024-07-29 22:10:16,949][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-29_22-10-16
[2024-07-29 22:13:12,541][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-29 22:13:12,547][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-29 22:13:12,547][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-29 22:13:12,607][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-29 22:13:13,022][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 981, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.datamodules.time_datamodule.TimeDataModule'; 'src.datamodules.time_datamodule' is not a package

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.datamodules.time_datamodule.TimeDataModule':
ModuleNotFoundError("No module named 'src.datamodules.time_datamodule.TimeDataModule'; 'src.datamodules.time_datamodule' is not a package")
Are you sure that 'TimeDataModule' is importable from module 'src.datamodules.time_datamodule'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 56, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.datamodule)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.datamodules.time_datamodule.TimeDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: datamodule
[2024-07-29 22:13:13,024][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-29_22-13-12
[2024-07-29 22:21:56,504][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-29 22:21:56,509][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-29 22:21:56,509][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-29 22:21:56,569][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-29 22:22:05,772][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-29 22:22:05,817][__main__][INFO] - Instantiating callbacks...
[2024-07-29 22:22:05,818][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-29 22:22:05,820][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-29 22:22:05,821][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-29 22:22:05,822][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-29 22:22:05,822][__main__][INFO] - Instantiating loggers...
[2024-07-29 22:22:05,823][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-29 22:22:05,823][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-29 22:22:05,968][__main__][INFO] - Starting training!
[2024-07-29 22:22:10,314][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 97, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 113, in validation_step
    self.val_acc(preds, targets)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 236, in forward
    self._forward_cache = self._forward_reduce_state_update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 302, in _forward_reduce_state_update
    self.update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 400, in wrapped_func
    raise err
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 390, in wrapped_func
    update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/classification/stat_scores.py", line 175, in update
    _binary_stat_scores_tensor_validation(preds, target, self.multidim_average, self.ignore_index)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/functional/classification/stat_scores.py", line 61, in _binary_stat_scores_tensor_validation
    _check_same_shape(preds, target)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/utilities/checks.py", line 41, in _check_same_shape
    raise RuntimeError(
RuntimeError: Predictions and targets are expected to have the same shape, but got torch.Size([32]) and torch.Size([32, 2]).
[2024-07-29 22:22:10,322][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-29_22-21-56
[2024-07-29 22:24:48,441][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-29 22:24:48,447][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-29 22:24:48,447][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-29 22:24:48,507][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-29 22:24:57,051][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-29 22:24:57,077][__main__][INFO] - Instantiating callbacks...
[2024-07-29 22:24:57,078][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-29 22:24:57,080][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-29 22:24:57,082][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-29 22:24:57,082][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-29 22:24:57,083][__main__][INFO] - Instantiating loggers...
[2024-07-29 22:24:57,083][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-29 22:24:57,084][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-29 22:24:57,196][__main__][INFO] - Starting training!
[2024-07-29 22:27:08,541][__main__][INFO] - Starting testing!
[2024-07-29 22:27:17,860][__main__][INFO] - Best ckpt path: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-29_22-24-48/checkpoints/epoch_000.ckpt
[2024-07-29 22:27:17,863][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-29_22-24-48
[2024-07-29 22:27:17,864][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-07-29 22:37:53,752][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-29 22:37:53,757][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-29 22:37:53,757][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-29 22:37:53,815][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-29 22:38:02,373][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-29 22:38:02,399][__main__][INFO] - Instantiating callbacks...
[2024-07-29 22:38:02,399][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-29 22:38:02,401][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-29 22:38:02,402][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-29 22:38:02,403][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-29 22:38:02,404][__main__][INFO] - Instantiating loggers...
[2024-07-29 22:38:02,404][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-29 22:38:02,404][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-29 22:38:02,511][__main__][INFO] - Starting training!
[2024-07-29 22:40:13,782][__main__][INFO] - Starting testing!
[2024-07-29 22:40:23,588][__main__][INFO] - Best ckpt path: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-29_22-37-53/checkpoints/epoch_000.ckpt
[2024-07-29 22:40:23,591][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-29_22-37-53
[2024-07-29 22:40:23,591][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-07-29 22:49:01,749][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-29 22:49:01,754][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-29 22:49:01,755][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-29 22:49:01,811][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-29 22:49:10,695][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-29 22:49:10,720][__main__][INFO] - Instantiating callbacks...
[2024-07-29 22:49:10,720][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-29 22:49:10,723][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-29 22:49:10,724][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-29 22:49:10,724][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-29 22:49:10,724][__main__][INFO] - Instantiating loggers...
[2024-07-29 22:49:10,725][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-29 22:49:10,725][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-29 22:49:10,834][__main__][INFO] - Starting training!
[2024-07-29 22:51:27,184][__main__][INFO] - Starting testing!
[2024-07-29 22:51:36,736][__main__][INFO] - Best ckpt path: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-29_22-49-01/checkpoints/epoch_000.ckpt
[2024-07-29 22:51:36,738][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-29_22-49-01
[2024-07-29 22:51:36,739][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-07-30 15:46:22,207][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-30 15:46:22,212][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-30 15:46:22,212][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-30 15:46:22,272][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-30 15:46:31,295][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-30 15:46:31,344][__main__][INFO] - Instantiating callbacks...
[2024-07-30 15:46:31,345][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-30 15:46:31,348][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-30 15:46:31,349][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-30 15:46:31,349][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-30 15:46:31,350][__main__][INFO] - Instantiating loggers...
[2024-07-30 15:46:31,350][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-30 15:46:31,350][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-30 15:46:31,496][__main__][INFO] - Starting training!
[2024-07-30 15:48:40,395][__main__][INFO] - Starting testing!
[2024-07-30 15:48:49,737][__main__][INFO] - Best ckpt path: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-30_15-46-22/checkpoints/epoch_000.ckpt
[2024-07-30 15:48:49,740][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-30_15-46-22
[2024-07-30 15:48:49,740][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2024-07-30 16:23:24,994][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-30 16:23:25,000][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-30 16:23:25,000][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-30 16:23:25,064][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-30 16:23:33,612][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-30 16:23:33,642][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 79, in __init__
    self.test_recall_c
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1614, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'TSModule' object has no attribute 'test_recall_c'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 62, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.time_module.TSModule':
AttributeError("'TSModule' object has no attribute 'test_recall_c'")
full_key: model
[2024-07-30 16:23:33,644][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-30_16-23-24
[2024-07-30 16:33:59,559][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-30 16:33:59,564][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-30 16:33:59,565][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-30 16:33:59,626][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-30 16:34:08,122][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-30 16:34:08,147][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 79, in __init__
    self.test_recall_c
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1614, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'TSModule' object has no attribute 'test_recall_c'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 62, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.time_module.TSModule':
AttributeError("'TSModule' object has no attribute 'test_recall_c'")
full_key: model
[2024-07-30 16:34:08,150][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-30_16-33-59
[2024-07-30 16:42:24,681][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-30 16:42:24,687][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-30 16:42:24,687][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-30 16:42:24,749][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-30 16:42:33,395][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-30 16:42:33,419][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 79, in __init__
    self.test_recall_c
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1614, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'TSModule' object has no attribute 'test_recall_c'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 62, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.time_module.TSModule':
AttributeError("'TSModule' object has no attribute 'test_recall_c'")
full_key: model
[2024-07-30 16:42:33,422][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-30_16-42-24
[2024-07-30 16:45:21,364][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-30 16:45:21,369][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-30 16:45:21,370][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-30 16:45:21,429][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-30 16:45:29,940][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-30 16:45:29,965][__main__][INFO] - Instantiating callbacks...
[2024-07-30 16:45:29,966][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-30 16:45:29,968][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-30 16:45:29,969][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-30 16:45:29,969][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-30 16:45:29,970][__main__][INFO] - Instantiating loggers...
[2024-07-30 16:45:29,970][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-30 16:45:29,971][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-30 16:45:30,120][__main__][INFO] - Starting training!
[2024-07-30 16:45:34,416][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 97, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 166, in validation_step
    self.log("val/precision_class0", precision[0], on_step=False, on_epoch=True, prog_bar=True)
IndexError: invalid index of a 0-dim tensor. Use `tensor.item()` in Python or `tensor.item<T>()` in C++ to convert a 0-dim tensor to a number
[2024-07-30 16:45:34,485][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-30_16-45-21
[2024-07-30 21:46:37,513][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-30 21:46:37,518][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-30 21:46:37,518][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-30 21:46:37,582][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-30 21:46:47,366][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-30 21:46:47,416][__main__][INFO] - Instantiating callbacks...
[2024-07-30 21:46:47,416][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-30 21:46:47,419][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-30 21:46:47,420][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-30 21:46:47,420][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-30 21:46:47,421][__main__][INFO] - Instantiating loggers...
[2024-07-30 21:46:47,421][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-30 21:46:47,421][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-30 21:46:47,555][__main__][INFO] - Starting training!
[2024-07-30 21:46:50,821][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 97, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 79, in validation_step
    self.log_metrics('val', loss, preds, targets)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 91, in log_metrics
    getattr(self, f'{stage}_acc')(preds, targets)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 236, in forward
    self._forward_cache = self._forward_reduce_state_update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 302, in _forward_reduce_state_update
    self.update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 390, in wrapped_func
    update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/classification/stat_scores.py", line 315, in update
    _multiclass_stat_scores_tensor_validation(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/functional/classification/stat_scores.py", line 298, in _multiclass_stat_scores_tensor_validation
    raise ValueError(
ValueError: Either `preds` and `target` both should have the (same) shape (N, ...), or `target` should be (N, ...) and `preds` should be (N, C, ...).
[2024-07-30 21:46:50,829][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-30_21-46-37
[2024-07-30 21:50:18,914][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-30 21:50:18,919][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-30 21:50:18,919][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-30 21:50:18,979][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-30 21:50:27,498][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-30 21:50:27,524][__main__][INFO] - Instantiating callbacks...
[2024-07-30 21:50:27,525][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-30 21:50:27,527][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-30 21:50:27,528][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-30 21:50:27,529][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-30 21:50:27,530][__main__][INFO] - Instantiating loggers...
[2024-07-30 21:50:27,530][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-30 21:50:27,530][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-30 21:50:27,641][__main__][INFO] - Starting training!
[2024-07-30 21:50:30,669][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 97, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 79, in validation_step
    self.log_metrics('val', loss, preds, targets)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 91, in log_metrics
    getattr(self, f'{stage}_acc')(preds, targets)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 236, in forward
    self._forward_cache = self._forward_reduce_state_update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 302, in _forward_reduce_state_update
    self.update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 390, in wrapped_func
    update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/classification/stat_scores.py", line 315, in update
    _multiclass_stat_scores_tensor_validation(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/functional/classification/stat_scores.py", line 298, in _multiclass_stat_scores_tensor_validation
    raise ValueError(
ValueError: Either `preds` and `target` both should have the (same) shape (N, ...), or `target` should be (N, ...) and `preds` should be (N, C, ...).
[2024-07-30 21:50:32,035][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-30_21-50-18
[2024-07-30 21:51:20,927][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-30 21:51:20,932][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-30 21:51:20,932][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-30 21:51:20,992][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-30 21:51:29,440][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-30 21:51:29,467][__main__][INFO] - Instantiating callbacks...
[2024-07-30 21:51:29,467][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-30 21:51:29,470][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-30 21:51:29,471][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-30 21:51:29,471][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-30 21:51:29,472][__main__][INFO] - Instantiating loggers...
[2024-07-30 21:51:29,472][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-30 21:51:29,472][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-30 21:51:29,586][__main__][INFO] - Starting training!
[2024-07-30 21:51:32,525][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 97, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 80, in validation_step
    self.log_metrics('val', loss, preds, targets)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 92, in log_metrics
    getattr(self, f'{stage}_acc')(preds, targets)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 236, in forward
    self._forward_cache = self._forward_reduce_state_update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 302, in _forward_reduce_state_update
    self.update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 390, in wrapped_func
    update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/classification/stat_scores.py", line 315, in update
    _multiclass_stat_scores_tensor_validation(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/functional/classification/stat_scores.py", line 298, in _multiclass_stat_scores_tensor_validation
    raise ValueError(
ValueError: Either `preds` and `target` both should have the (same) shape (N, ...), or `target` should be (N, ...) and `preds` should be (N, C, ...).
[2024-07-30 21:51:33,498][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-30_21-51-20
[2024-07-30 21:52:47,157][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-30 21:52:47,163][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-30 21:52:47,163][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-30 21:52:47,223][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-30 21:52:55,624][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-30 21:52:55,650][__main__][INFO] - Instantiating callbacks...
[2024-07-30 21:52:55,650][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-30 21:52:55,653][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-30 21:52:55,654][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-30 21:52:55,654][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-30 21:52:55,655][__main__][INFO] - Instantiating loggers...
[2024-07-30 21:52:55,655][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-30 21:52:55,656][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-30 21:52:55,769][__main__][INFO] - Starting training!
[2024-07-30 21:52:58,981][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/train.py", line 97, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/lightning/pytorch/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 94, in validation_step
    self.log_metrics('val', loss, preds, targets)
  File "/Users/rishabh/TimeSeries-Interpretability-Robustness/src/models/time_module.py", line 107, in log_metrics
    getattr(self, f'{stage}_acc')(preds, targets)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 236, in forward
    self._forward_cache = self._forward_reduce_state_update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 302, in _forward_reduce_state_update
    self.update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/metric.py", line 390, in wrapped_func
    update(*args, **kwargs)
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/classification/stat_scores.py", line 315, in update
    _multiclass_stat_scores_tensor_validation(
  File "/Users/rishabh/opt/anaconda3/envs/pytorchenv/lib/python3.9/site-packages/torchmetrics/functional/classification/stat_scores.py", line 288, in _multiclass_stat_scores_tensor_validation
    raise ValueError(
ValueError: ('The `preds` and `target` should have the same shape,', ' got `preds` with shape=torch.Size([32]) and `target` with shape=torch.Size([64]).')
[2024-07-30 21:52:59,748][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-30_21-52-47
[2024-07-30 21:54:38,087][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2024-07-30 21:54:38,092][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2024-07-30 21:54:38,093][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2024-07-30 21:54:38,152][__main__][INFO] - Instantiating datamodule <src.datamodules.time_datamodule.TimeDataModule>
[2024-07-30 21:54:46,582][__main__][INFO] - Instantiating model <src.models.time_module.TSModule>
[2024-07-30 21:54:46,609][__main__][INFO] - Instantiating callbacks...
[2024-07-30 21:54:46,610][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-07-30 21:54:46,612][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-07-30 21:54:46,614][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-07-30 21:54:46,614][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-07-30 21:54:46,615][__main__][INFO] - Instantiating loggers...
[2024-07-30 21:54:46,615][src.utils.instantiators][WARNING] - No logger configs found! Skipping...
[2024-07-30 21:54:46,615][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2024-07-30 21:54:46,726][__main__][INFO] - Starting training!
[2024-07-30 21:56:59,729][__main__][INFO] - Starting testing!
[2024-07-30 21:57:09,013][__main__][INFO] - Best ckpt path: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-30_21-54-38/checkpoints/epoch_000.ckpt
[2024-07-30 21:57:09,017][src.utils.utils][INFO] - Output dir: /Users/rishabh/TimeSeries-Interpretability-Robustness/logs/train/runs/2024-07-30_21-54-38
[2024-07-30 21:57:09,018][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
